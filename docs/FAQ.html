<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Nodeny - FAQ</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link rel='stylesheet' href='i/nody.css' type='text/css'>
</head>
<body>
<div class='mainbody'>
<table border=0 width=90% class="coment"><tr>
<td><a href="index.html"><img src="i/logo.gif" border=0 valign=middle></a></td>
<td align=center><b>Биллинговая система NoDeny. FAQ</b></td>
</tr></table>
<br>
<br>


<div class='mainbody'>

<ul>
<li><a href="#dontshow">В админке не показыват то, что я хочу увидеть</a></li>
<li><a href="#entererr">Забыт пароль администратора либо удалена административная запись</a></li>
<li><a href="#noauth">Авторизация в веб-интерфейсе администратора не проходит</a></li>
<li><a href="#harderr">NoDeny `перестал работать` после пропадания электропитания или иного аппаратного сбоя</a></li>
<li><a href="#shapeerr">Делаю все по инструкции, управление доступом работает, но скорости не шейпятся</a></li>
<li><a href="#wanna">Я хочу кое-что изменить в коде NoDeny, но боюсь</a></li>
</ul>


<li><a name="dontshow">В админке не показыват то, что я хочу увидеть<a/></li>
<div class="code">
Не забывайте, что в NoDeny довольно развернутая система привилегий, позволяющая разграничивать данные
разных отделов, сетей и т.д. Если вы не можете найти абонента, платеж или иное, то воспользуйтесь системой
вывода отладочных сообщений - зайтите в личные настройки и поставьте галку на параметре
&#171;Режим вывода отладочных сообщений&#187;. В результате этого действия в верхнем меню появится кнопка
&#171;Debug&#187;, при нажатии на которую откроется окно с отладочными сообщениями. Конечно, большинство
сообщений доступны для понимания специалисту, однако некоторые могут подсказать, какие у вас ограничения
где стоят и что не включено или заблокировано.<br>
<br>
</div>
<br>
<br>
<br>

<li><a name="entererr">Забыт пароль администратора либо удалена административная запись<a/></li>
<div class="code">
Может так случиться, что после ошибочных действий вы запретите всем администраторам доступ к функциям изменения настроек
и привилегий. В этом случае вам необходимо воспользоваться системным логином <em>admin</em>, пароль вы должны внести
вручную в конфигурационный файл, т.е. строку `<em>$sadmin='пароль';</em>`<br>
<br>
Например:<br>
<br>
<pre>bash# echo "\$sadmin='12345';" >> /usr/local/nodeny/nodeny.cfg.pl</pre>
<br>
Логиньтесь в админке:<br>
<br>
логин: admin<br>
пароль: 12345<br>
<br>
После переключения на другого администратора и изменения настроек этот пароль удалится из конфига автоматически.<br>
<br>
</div>
<br>
<br>
<br>


<li><a name="noauth">Авторизация в веб-интерфейсе администратора не проходит<a/></li>
<div class="code">
Если выводится сообщение "ошибка номер ..." - читайте <a href='h/work.html#ermess'>здесь</a>.<br>
<br>
Убедитесь, что:<br>
<br>
- в вашем браузере разрешено выполнение javascript;<br>
<br>
- скрипт md5.js может быть загружен вашей системой: откройте в браузере <em>https://server/i/md5.js</em> - должен либо 
открыться этот файл либо вывестись предложение о его сохранении;<br>
<br>
- если вы пытаетесь залогиниться под системным логином, то пароль к этому логину присутствует в конфиге
<em>/usr/local/nodeny/nodeny.cfg.pl</em> - строка <em>$sadmin = 'пароль';</em>
</div>
<br>
<br>



<li><a name="harderr">NoDeny `перестал работать` после пропадания электропитания или иного аппаратного сбоя</a></li>
<div class="code">
В подавляющем большинстве случаев при некорректном останове системы, например, аварийном выключении
при пропадании электропитания, страдает структура базы данных. Для анализа и восстановления БД в mysql
применяется утилита mysqlcheck:<br>
<br>
bash# grep Db_pw /usr/local/nodeny/nodeny.cfg<br>
bash# mysqlcheck -p -u bill_kernel bill<br>
<br>
Если есть таблицы с поврежденной структурой, то необходимо запустить утилиту с указанием отремонтировать такие таблицы:<br>
<br>
bash# mysqlcheck -repair -p -u bill_kernel bill<br>
<br>
<br>
Возможно была повреждена логическая структура разделов системы:<br>
<br>
bash# fsck -y<br>
<br>
Смотрите логи:<br>
<br>
bash# tail /var/log/httpd-error.log<br>
bash# tail /usr/local/nodeny/nodeny.log<br>
bash# tail /usr/local/nodeny/noserver.log<br>
<br>
они помогут выяснить причину проблемы.<br>
</div>
<br>
<br>





<li><a name="shapeerr">Делаю все по инструкции, управление доступом работает, но скорости не шейпятся</a></li>
<div class="code">
Вероятно, вы остановились на полпути. Инструкция по установке NoDeny построена таким образом, что сначала
настраивается упрощенное решение, которое предназначено для быстрого старта и не предусматривает
управление шейпами. Вам необходимо прочитать слегка больше и привести правила фаервола в окончательный вид,
например, <a href='h/firewall.html#realfire'>так</a>. Учтите, что финальный вариант может несколько отличаться
от приведенного в зависимости от типа nat-а и коллектора, которые вы выбрали.

<br>
</div>
<br>
<br>


<li><a name="wanna">Я хочу кое-что изменить в коде NoDeny, но боюсь<a/></li>
<div class="code">
Изменение кода не запрещается, однако не забывайте, что автор может отказать в поддержке
NoDeny с вашими изменениями. В любом случае перед тем как что-то изменить - сделайте
<a href='h/work.html#backup'>backup базы данных</a> и конфигов.<br>
<br>


При внесении дополнений в код NoDeny, не забывайте проверять передаваемые параметры, поскольку
их подделать не составляет труда. Не забывайте фильтровать спецсимволы для html и mysql, не забывайте,
что они разные - для mysql важно отфильтровать &#171;'&#187; и &#171;\&#187;, для html -
&#171;&lt;&#187;, &#171;&gt;&#187; и &#171;&amp;&#187;.<br>
<br>
</div>
<br>
<br>

</div>

<br><br><br><br>
<br>
<br>
<br>
<br></body>
</html>
